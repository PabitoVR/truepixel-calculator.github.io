<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TruePixel Calculator</title>
    
    <!-- IKONA (FAVICON) - Ciemny chip z różowym rdzeniem -->
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCI+PHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiByeD0iMTIiIGZpbGw9IiMwZjE3MmEiLz48cmVjdCB4PSIyMCIgeT0iMjAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iI2VjNDg5OSIvPjxwYXRoIGQ9Ik0zMiA0djEyTTMyIDQ4djEyTTQgMzJoMTJNNDggMzJoMTIiIHN0cm9rZT0iI2VjNDg5OSIgc3Ryb2tlLXdpZHRoPSI2Ii8+PC9zdmc+">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            400: '#f472b6', // Pink 400
                            500: '#ec4899', // Pink 500
                            600: '#db2777', // Pink 600
                        },
                        ai: {
                            400: '#c084fc', // Purple 400
                            500: '#a855f7', // Purple 500
                            600: '#9333ea', // Purple 600
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-slow': 'bounce 2s infinite',
                    },
                    transitionTimingFunction: {
                        'bounce-sm': 'cubic-bezier(0.4, 0, 0.2, 1)',
                    }
                }
            }
        }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s, color 0.3s;
            overflow-x: hidden;
        }
        
        /* HIDE SCROLLBAR BUT ALLOW SCROLLING */
        ::-webkit-scrollbar { display: none; }
        body { -ms-overflow-style: none; scrollbar-width: none; }

        .mono { font-family: 'JetBrains Mono', monospace; }

        .glass-panel {
            backdrop-filter: blur(12px);
            transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
        }

        html.dark .glass-panel {
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        html:not(.dark) .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        /* Range Slider */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%;
            background: #ec4899; cursor: pointer; margin-top: -6px; 
            box-shadow: 0 0 10px rgba(236, 72, 153, 0.5);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #cbd5e1; border-radius: 2px;
        }
        html.dark input[type=range]::-webkit-slider-runnable-track { background: #334155; }
        
        /* AI Response Styling */
        .ai-response p { margin-bottom: 0.5rem; }
        .ai-response strong { color: #f472b6; font-weight: 700; }
        .ai-response ul { list-style-type: disc; padding-left: 1.2rem; margin-bottom: 0.5rem; }
        .ai-response li { margin-bottom: 0.2rem; }
        html:not(.dark) .ai-response strong { color: #db2777; }

        /* Navigation Tab Active/Inactive */
        .nav-tab.active {
            color: #ec4899; /* Pink 500 */
            border-bottom: 2px solid #ec4899;
        }
        .nav-tab.inactive {
            color: #64748b; /* Slate 500 */
            border-bottom: 2px solid transparent;
        }
        html.dark .nav-tab.inactive { color: #94a3b8; /* Slate 400 */ }
        .nav-tab:hover { color: #ec4899; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-200 selection:bg-primary-500 selection:text-white transition-colors duration-300">

    <!-- Navbar -->
    <nav class="w-full p-4 lg:p-6 flex flex-col md:flex-row justify-between items-center border-b border-slate-200 dark:border-slate-800 bg-white/50 dark:bg-slate-900/50 fixed top-0 z-50 backdrop-blur-md transition-colors duration-300 gap-4 md:gap-0">
        
        <!-- Logo -->
        <div class="flex items-center gap-3">
            <i class="fa-solid fa-microchip text-primary-500 text-2xl"></i>
            <span class="text-xl font-bold tracking-tight dark:text-white text-slate-900">TRUE<span class="text-primary-500">PIXEL</span></span>
        </div>

        <!-- Center Tabs -->
        <div class="flex items-center gap-8">
            <button onclick="switchView('calculator')" id="tab-calculator" class="nav-tab active text-sm font-bold uppercase tracking-wider py-2 transition-all">
                <i class="fa-solid fa-calculator mr-2"></i><span data-i18n="tabCalc">Calculator</span>
            </button>
            <button onclick="switchView('manifest')" id="tab-manifest" class="nav-tab inactive text-sm font-bold uppercase tracking-wider py-2 transition-all">
                <i class="fa-solid fa-scroll mr-2"></i><span data-i18n="tabWhy">Why?</span>
            </button>
        </div>
        
        <!-- Right Controls -->
        <div class="flex items-center gap-4">
            <button id="langToggle" onclick="toggleLanguage()" class="flex items-center gap-2 text-sm font-bold px-3 py-1.5 rounded-full border border-slate-300 dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 transition text-slate-700 dark:text-slate-200">
            </button>
            <button onclick="toggleTheme()" class="w-10 h-10 rounded-full flex items-center justify-center bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-yellow-400 hover:bg-slate-300 dark:hover:bg-slate-700 transition">
                <i id="themeIcon" class="fa-solid fa-sun"></i>
            </button>
        </div>
    </nav>

    <!-- Main Content Wrapper -->
    <main class="relative min-h-screen pt-28">

        <!-- VIEW 1: CALCULATOR -->
        <div id="view-calculator" class="transition-opacity duration-300">
            <!-- Calculator Content -->
            <div class="container mx-auto px-4 pb-32 flex flex-col lg:flex-row gap-8 lg:gap-12 items-start justify-center relative z-10">

                <!-- LEFT COLUMN: Inputs & Calculate -->
                <div class="w-full lg:w-1/2 max-w-xl mx-auto lg:mx-0 flex flex-col h-full justify-between">
                    <div class="glass-panel rounded-2xl p-6 lg:p-8 shadow-2xl shadow-primary-900/10">
                        <h1 class="text-3xl font-extrabold mb-2 dark:text-white text-slate-900" data-i18n="title">Calculate Performance</h1>
                        <p class="text-slate-500 dark:text-slate-400 mb-8" data-i18n="subtitle">Forget "4K". See how much your GPU actually calculates.</p>

                        <!-- Inputs -->
                        <div class="grid grid-cols-2 gap-6 mb-8">
                            <div>
                                <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 mb-2 mono uppercase" data-i18n="widthLabel">WIDTH (PX)</label>
                                <input type="number" id="widthInput" value="2560" class="w-full bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 text-slate-900 dark:text-white focus:outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-500 transition font-mono text-lg font-bold">
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 mb-2 mono uppercase" data-i18n="heightLabel">HEIGHT (PX)</label>
                                <input type="number" id="heightInput" value="1440" class="w-full bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 text-slate-900 dark:text-white focus:outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-500 transition font-mono text-lg font-bold">
                            </div>
                        </div>

                        <!-- Presets -->
                        <div class="mb-8">
                            <p class="text-xs text-slate-500 dark:text-slate-500 uppercase tracking-wider font-bold mb-3" data-i18n="presetsLabel">QUICK PRESETS</p>
                            <div class="relative flex flex-wrap gap-2" id="presetContainer">
                                <div id="activePill" class="absolute h-full top-0 left-0 bg-primary-500 rounded shadow-lg shadow-primary-500/40 transition-all duration-300 ease-bounce-sm opacity-0 -z-0 pointer-events-none"></div>
                            </div>
                        </div>

                        <!-- Calculate Action -->
                        <button onclick="calculateMP()" class="w-full bg-primary-600 hover:bg-primary-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-primary-600/20 transition transform hover:-translate-y-0.5 active:translate-y-0 mb-6">
                            <span data-i18n="calcButton">CALCULATE MP STANDARD</span>
                        </button>
                    </div>
                </div>

                <!-- RIGHT COLUMN: Results & Verdict -->
                <div class="w-full lg:w-1/2 max-w-xl mx-auto lg:mx-0 flex flex-col gap-6">
                    
                    <!-- Placeholder State -->
                    <div id="placeholderState" class="flex flex-col items-center justify-center h-[500px] text-slate-400 dark:text-slate-600 border-2 border-dashed border-slate-300 dark:border-slate-800 rounded-2xl">
                        <i class="fa-solid fa-calculator text-4xl mb-4 text-slate-300 dark:text-slate-700"></i>
                        <p class="font-medium" data-i18n="placeholderText">Enter data and press Calculate</p>
                    </div>

                    <!-- Active Results Panel -->
                    <div id="resultPanel" class="hidden opacity-0 transition-opacity duration-500 flex flex-col gap-6">
                        
                        <!-- Main Metric -->
                        <div class="glass-panel rounded-2xl p-6 lg:p-8 border-primary-500/30 relative overflow-hidden flex-1">
                            <div class="absolute top-0 right-0 w-48 h-48 bg-primary-500/10 dark:bg-primary-500/20 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none"></div>
                            
                            <h2 class="text-slate-500 dark:text-slate-400 text-xs font-bold tracking-widest uppercase mb-1" data-i18n="loadLabel">GPU LOAD</h2>
                            <div class="flex items-baseline gap-2">
                                <span id="mpValue" class="text-6xl font-extrabold text-slate-900 dark:text-white tracking-tighter">3.69</span>
                                <span class="text-2xl font-bold text-primary-500">MP</span>
                            </div>
                            <p id="className" class="text-xl mt-2 font-medium text-slate-700 dark:text-slate-300">Class 4M</p>
                            
                            <div class="mt-6 pt-6 border-t border-slate-200 dark:border-slate-700/50">
                                <div class="flex justify-between text-sm mb-2">
                                    <span class="text-slate-500 dark:text-slate-400" data-i18n="vsFhdLabel">Vs FHD (1080p):</span>
                                    <span id="percentageDiff" class="font-bold text-emerald-500">+77% pixels</span>
                                </div>
                                <div class="w-full h-3 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden relative">
                                    <div class="absolute left-[25%] top-0 bottom-0 w-px bg-slate-400/50 dark:bg-slate-600/50 z-10" title="FHD (2MP)"></div>
                                    <div class="absolute left-[44%] top-0 bottom-0 w-px bg-slate-400/50 dark:bg-slate-600/50 z-10" title="QHD (3.7MP)"></div>
                                    <div class="absolute left-[100%] top-0 bottom-0 w-px bg-slate-400/50 dark:bg-slate-600/50 z-10" title="4K (8.3MP)"></div>
                                    <div id="progressBar" class="h-full bg-gradient-to-r from-primary-400 to-primary-600 transition-all duration-1000 ease-out" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Verdict -->
                        <div class="glass-panel rounded-2xl p-6 flex-1">
                            <h3 class="font-bold text-slate-900 dark:text-white mb-3 flex items-center gap-2">
                                <i class="fa-solid fa-circle-info text-primary-500"></i>
                                <span data-i18n="verdictTitle">Verdict</span>
                            </h3>
                            <p id="verdictText" class="text-slate-600 dark:text-slate-300 leading-relaxed text-sm">
                                Calculated verdict will appear here.
                            </p>
                        </div>

                    </div>
                </div>
            </div>

            <!-- FADE OVERLAY AT BOTTOM -->
            <div id="bottomFade" class="fixed bottom-0 left-0 w-full h-32 bg-gradient-to-t from-slate-50 dark:from-slate-950 to-transparent pointer-events-none z-20 transition-opacity duration-500"></div>

            <!-- FLOATING NAVIGATION BUTTON -->
            <button id="navFab" class="fixed left-1/2 transform -translate-x-1/2 z-50 px-6 py-3 bg-slate-900 dark:bg-slate-800 text-white dark:text-primary-400 rounded-full shadow-2xl shadow-primary-500/20 border border-slate-700 dark:border-primary-500/30 flex items-center justify-center gap-3 cursor-pointer hover:scale-105 transition-all duration-300 bottom-8">
                <span id="navFabText" class="font-bold text-sm tracking-wide">Ask Advisor</span>
                <i id="navFabIcon" class="fa-solid fa-arrow-down text-lg"></i>
            </button>

            <!-- SCREEN 2: AI Advisor (Below Fold) -->
            <div id="aiSection" class="w-full relative bg-slate-100 dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 pt-24 pb-24 z-0">
                <div class="container mx-auto px-4 max-w-4xl relative z-10">
                    <div class="text-center mb-10">
                        <h3 class="text-3xl font-extrabold text-slate-900 dark:text-white mb-3 flex items-center justify-center gap-3">
                            <i class="fa-solid fa-wand-magic-sparkles text-ai-500"></i>
                            <span data-i18n="aiTitle">AI Hardware Advisor</span>
                        </h3>
                        <p class="text-slate-500 dark:text-slate-400" data-i18n="aiSubtitle">Ask Gemini which specific GPUs are recommended for this load.</p>
                    </div>

                    <div class="glass-panel rounded-2xl p-8 border-ai-500/30 shadow-2xl shadow-ai-500/10 max-w-2xl mx-auto">
                        <button onclick="askGemini()" id="aiButton" class="w-full flex items-center justify-center gap-3 bg-gradient-to-r from-ai-600 to-purple-700 hover:from-ai-500 hover:to-purple-600 text-white font-bold py-4 rounded-xl transition-all duration-300 group shadow-lg shadow-ai-600/20">
                            <i class="fa-solid fa-robot text-xl group-hover:scale-110 transition-transform"></i>
                            <span data-i18n="aiButtonText">Ask AI for GPU Recommendations</span>
                        </button>

                        <!-- AI Result -->
                        <div id="aiResult" class="hidden mt-6 pt-6 border-t border-slate-200 dark:border-slate-700/50">
                            <div id="aiLoading" class="hidden flex flex-col items-center justify-center gap-3 py-6 text-ai-500">
                                <i class="fa-solid fa-circle-notch fa-spin text-3xl"></i>
                                <span class="text-sm font-medium animate-pulse">Analyzing pixel density & VRAM requirements...</span>
                            </div>
                            <div id="aiContent" class="text-sm lg:text-base text-slate-700 dark:text-slate-300 leading-relaxed ai-response"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VIEW 2: MANIFESTO (Hidden by Default) -->
        <div id="view-manifest" class="hidden transition-opacity duration-300 pb-24">
            <div class="container mx-auto px-4 max-w-3xl">
                <div class="glass-panel rounded-3xl p-8 lg:p-12 shadow-2xl shadow-primary-900/10 relative overflow-hidden">
                    
                    <!-- Decorative BG Elements -->
                    <div class="absolute top-0 right-0 w-64 h-64 bg-primary-500/5 rounded-full blur-3xl -mr-32 -mt-32"></div>
                    <div class="absolute bottom-0 left-0 w-64 h-64 bg-ai-500/5 rounded-full blur-3xl -ml-32 -mb-32"></div>

                    <h1 class="text-4xl lg:text-5xl font-extrabold mb-2 dark:text-white text-slate-900 tracking-tight" data-i18n="manifestTitle">Why TruePixel?</h1>
                    <p class="text-xl text-primary-500 font-bold mb-10" data-i18n="manifestSubtitle">Stop pretending pixels are flat.</p>
                    
                    <div class="prose dark:prose-invert prose-slate lg:prose-lg max-w-none">
                        <div data-i18n-html="manifestContent">
                            <!-- Default English Content (will be replaced by JS based on lang) -->
                        </div>
                    </div>
                    
                    <div class="mt-12 pt-8 border-t border-slate-200 dark:border-slate-800 text-center">
                        <p class="text-sm text-slate-500 dark:text-slate-400">Author: <strong class="text-slate-900 dark:text-white">Jakub Pabisz</strong></p>
                        <p class="text-xs text-slate-400 dark:text-slate-600 mt-1" data-i18n="authorTagline">Because labels are lying.</p>
                    </div>

                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="text-center py-8 text-slate-400 dark:text-slate-600 text-sm border-t border-slate-200 dark:border-slate-800 bg-white/50 dark:bg-slate-900/50 backdrop-blur-sm flex flex-col items-center gap-4">
        <p>&copy; 2026 TruePixel Standard. Created by <span class="font-bold text-primary-500">Jakub Pabisz</span>.</p>
        
        <!-- Placeholder for Donation Button -->
        <div class="flex items-center gap-2 px-4 py-2 bg-slate-100 dark:bg-slate-800/50 text-slate-400 dark:text-slate-500 rounded-full text-xs font-bold border border-slate-200 dark:border-slate-700/50 cursor-default opacity-70">
            <i class="fa-solid fa-mug-hot"></i>
            <span data-i18n="coffeeComingSoon">Ko-Fi.com donations coming soon</span>
        </div>
    </footer>

    <script>
        // --- API CONFIG ---
        const k1 = "AIzaSyBTQC1-kt1zTCe"; // Pierwsza połowa
        const k2 = "MNkRCeVgMZiO_FhocKDU";     // Druga połowa
        const apiKey = k1 + k2;

        // --- ASSETS ---
        const flags = {
            en: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 30" class="w-6 h-4 rounded shadow-sm"><rect width="50" height="30" fill="#b22234"/><path d="M0,4.6h50M0,9.2h50M0,13.8h50M0,18.5h50M0,23.1h50" stroke="#fff" stroke-width="2.3"/><rect width="20" height="16" fill="#3c3b6e"/><path d="M2,2l2,2M6,2l-2,2M10,2l2,2M14,2l-2,2M18,2l2,2" stroke="#fff" stroke-width="1" stroke-linecap="round"/></svg>`,
            pl: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 30" class="w-6 h-4 rounded shadow-sm border border-slate-200 dark:border-transparent"><rect width="50" height="15" fill="#fff"/><rect y="15" width="50" height="15" fill="#dc143c"/></svg>`
        };

        // --- MANIFEST CONTENT (PL) ---
        const manifestPL = `
            <p><strong>Mamy 2026 rok, a my wciąż kłamiemy na temat sprzętu.</strong></p>
            <p>Kupujesz monitor "1440p". Kupujesz monitor "Ultrawide 1440p". Brzmi podobnie, prawda? Tyle samo w pionie. Ale Twoja karta graficzna widzi coś zupełnie innego.</p>
            <ul>
                <li>Zwykłe 1440p to <strong>3.6 miliona pikseli</strong>.</li>
                <li>Ultrawide 1440p to <strong>prawie 5 milionów pikseli</strong>.</li>
            </ul>
            <p>To <strong>35% różnicy</strong> w wydajności. Karta, która śmiga w pierwszym przypadku, w drugim zaczyna się dławić. A my wciąż używamy nazw z epoki telewizorów kineskopowych: FHD, QHD, UHD. Te nazwy są mylące. Są przestarzałe. I przede wszystkim – są nieuczciwe wobec graczy.</p>
            <h3>Dlatego stworzyłam TruePixel (Standard MP).</h3>
            <p>To prosta idea: <strong>Piksel to piksel.</strong> Twój komputer nie widzi "szerokiego ekranu". Widzi macierz punktów do pokolorowania 60 razy na sekundę.</p>
            <p>Zamiast zgadywać, czy Twój RTX pociągnie nowy monitor, patrzysz na <strong>Klasę MP</strong>:</p>
            <ul class="list-none pl-0 space-y-2 my-4">
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-slate-200 dark:bg-slate-800 rounded text-xs font-bold">Klasa ↓2M</span> <span class="text-sm">Poniżej 1080p. Poziom podstawowy.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-slate-200 dark:bg-slate-800 rounded text-xs font-bold">Klasa 2M</span> <span class="text-sm">1920x1080. Punkt wyjścia.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-pink-100 dark:bg-pink-900/30 text-pink-600 dark:text-pink-400 rounded text-xs font-bold">Klasa 4M</span> <span class="text-sm">1440p. Nowy standard gamingu.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded text-xs font-bold">Klasa 5M↑</span> <span class="text-sm">Ultrawide. Wysokie wymagania.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-slate-800 dark:bg-white text-white dark:text-black rounded text-xs font-bold">Klasa 8M↑</span> <span class="text-sm">4K UHD. Klasa entuzjasty.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-purple-600 text-white rounded text-xs font-bold">Klasa 33M↑</span> <span class="text-sm">8K/16K. Poza zasięgiem obecnych GPU w AAA.</span></li>
            </ul>
            <p><strong>TruePixel to narzędzie, które brutalnie sprowadza marketing do parteru matematyki.</strong> Pokazuje czarno na białym, o ile % trudniej ma Twój komputer. To kalkulator, który nie bierze jeńców.</p>
            <p class="italic text-sm mt-8 border-l-4 border-primary-500 pl-4 py-1">Bo Twoja karta graficzna zasługuje na to, żebyś wiedział, co jej robisz.</p>
        `;

        const manifestEN = `
            <p><strong>It's 2026, and we're still lying about hardware.</strong></p>
            <p>You buy a "1440p" monitor. You buy an "Ultrawide 1440p". Sounds similar, right? Vertical count is the same. But your GPU sees something completely different.</p>
            <ul>
                <li>Standard 1440p is <strong>3.6 million pixels</strong>.</li>
                <li>Ultrawide 1440p is <strong>nearly 5 million pixels</strong>.</li>
            </ul>
            <p>That's a <strong>35% difference</strong> in performance load. A card that flies in the first case starts to choke in the second. Yet we still use names from the CRT TV era: FHD, QHD, UHD. These names are misleading. They are outdated. And above all—they are dishonest to gamers.</p>
            <h3>That's why I created TruePixel (MP Standard).</h3>
            <p>It's a simple idea: <strong>A pixel is a pixel.</strong> Your computer doesn't see a "wide screen". It sees a matrix of dots to color 60 times a second.</p>
            <p>Instead of guessing if your RTX can handle a new monitor, look at the <strong>MP Class</strong>:</p>
            <ul class="list-none pl-0 space-y-2 my-4">
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-slate-200 dark:bg-slate-800 rounded text-xs font-bold">Class ↓2M</span> <span class="text-sm">Sub-1080p. Entry Level.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-slate-200 dark:bg-slate-800 rounded text-xs font-bold">Class 2M</span> <span class="text-sm">1920x1080. The Baseline.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-pink-100 dark:bg-pink-900/30 text-pink-600 dark:text-pink-400 rounded text-xs font-bold">Class 4M</span> <span class="text-sm">1440p. Modern Standard.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded text-xs font-bold">Class 5M↑</span> <span class="text-sm">Ultrawide. High Performance.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-slate-800 dark:bg-white text-white dark:text-black rounded text-xs font-bold">Class 8M↑</span> <span class="text-sm">4K UHD. Enthusiast Grade.</span></li>
                <li class="flex items-center gap-2"><span class="px-2 py-1 bg-purple-600 text-white rounded text-xs font-bold">Class 33M↑</span> <span class="text-sm">8K/16K. Currently beyond consumer GPUs in AAA.</span></li>
            </ul>
            <p><strong>TruePixel is a tool that brutally brings marketing down to the ground of mathematics.</strong> It shows black on white how much harder your computer has to work. It's a calculator that takes no prisoners.</p>
            <p class="italic text-sm mt-8 border-l-4 border-primary-500 pl-4 py-1">Because your GPU deserves for you to know what you are doing to it.</p>
        `;

        // --- TRANSLATIONS ---
        const translations = {
            en: {
                tabCalc: "Calculator",
                tabWhy: "Why?",
                title: "Calculate Performance",
                subtitle: "Forget \"4K\". See how much your GPU actually calculates.",
                widthLabel: "WIDTH (PX)",
                heightLabel: "HEIGHT (PX)",
                presetsLabel: "QUICK PRESETS",
                calcButton: "CALCULATE MP STANDARD",
                loadLabel: "GPU LOAD",
                vsFhdLabel: "Vs FHD (1080p):",
                verdictTitle: "Verdict",
                placeholderText: "Enter data and press Calculate",
                pixels: "pixels",
                load: "load vs FHD",
                aiTitle: "AI Hardware Advisor",
                aiSubtitle: "Get GPU recommendations.",
                aiButtonText: "Ask AI",
                navAsk: "Ask Advisor",
                navBack: "Get Back",
                coffeeComingSoon: "Ko-Fi.com donations coming soon",
                manifestTitle: "Why TruePixel?",
                manifestSubtitle: "Stop pretending pixels are flat.",
                authorTagline: "Because labels are lying.",
                verdicts: {
                    legacy: "Entry Level. Below modern gaming standards. Good for basic tasks or older games.",
                    fhd: "1080p Standard. The most popular baseline. Easy to run for most modern GPUs.",
                    qhd: "Modern Gaming Standard (1440p). Offers a great balance between sharpness and performance.",
                    uw: "High Performance. Ultrawide or high resolution. Requires a powerful GPU for smooth framerates.",
                    uhd: "Enthusiast Grade (4K). Significant GPU load. Requires top-tier hardware for high settings.",
                    extreme: "Extreme Resolution (8K+). Currently beyond the capabilities of consumer GPUs for AAA gaming."
                },
                classes: {
                    legacy: "Class ↓2M (Entry)",
                    fhd: "Class 2M (Standard)",
                    qhd: "Class 4M (Modern)",
                    uw: "Class 5M↑ (High Res)",
                    uhd: "Class 8M↑ (Enthusiast)",
                    extreme: "Class 33M↑ (Extreme)"
                }
            },
            pl: {
                tabCalc: "Kalkulator",
                tabWhy: "Dlaczego?",
                title: "Oblicz Wydajność",
                subtitle: "Zapomnij o \"4K\". Sprawdź, ile naprawdę musi liczyć Twoja karta.",
                widthLabel: "SZEROKOŚĆ (PX)",
                heightLabel: "WYSOKOŚĆ (PX)",
                presetsLabel: "SZYBKIE WYBORY",
                calcButton: "PRZELICZ NA STANDARD MP",
                loadLabel: "OBCIĄŻENIE GPU",
                vsFhdLabel: "Względem FHD (1080p):",
                verdictTitle: "Werdykt",
                placeholderText: "Wprowadź dane i naciśnij Przelicz",
                pixels: "pikseli",
                load: "obciążenia vs FHD",
                aiTitle: "Doradca Sprzętowy AI",
                aiSubtitle: "Sprawdź rekomendacje GPU.",
                aiButtonText: "Zapytaj AI",
                navAsk: "Zapytaj doradcy",
                navBack: "Wróć",
                coffeeComingSoon: "Wsparcie przez Ko-Fi wkrótce",
                manifestTitle: "Dlaczego TruePixel?",
                manifestSubtitle: "Przestańmy udawać, że piksele są płaskie.",
                authorTagline: "Bo etykiety kłamią.",
                verdicts: {
                    legacy: "Poziom podstawowy. Poniżej współczesnych standardów gamingu. Wystarczy do starszych gier.",
                    fhd: "Standard światowy (1080p). Punkt odniesienia. Większość kart jest projektowana pod ten wynik.",
                    qhd: "Złoty środek (1440p / Ultrawide). Wymaga solidnego GPU. Prawie 2x więcej roboty niż FHD.",
                    uw: "Teren podwyższonego ryzyka. Super Ultrawide lub wysokie DPI. Zwykłe karty tu klękają.",
                    uhd: "Waga ciężka. 8.3 miliona pikseli co klatkę. 4x więcej niż standard. Wymaga topowego sprzętu.",
                    extreme: "God Mode. To już nie są piksele, to gęstość rzeczywistości. Potrzebujesz serwerowni, a nie PC."
                },
                classes: {
                    legacy: "Klasa ↓2M (Entry)",
                    fhd: "Klasa 2M (Standard)",
                    qhd: "Klasa 4M (Modern)",
                    uw: "Klasa 5M↑ (High Res)",
                    uhd: "Klasa 8M↑ (Enthusiast)",
                    extreme: "Klasa 33M↑ (Extreme)"
                }
            }
        };

        // --- STATE ---
        let currentLang = 'en';
        let currentTheme = 'dark';
        let currentView = 'calculator';
        let isFabAtTop = false; // Tracks logical position
        let isTransitioning = false; // Locks transition to prevent flicker
        
        const presets = [
            { label: "FHD", w: 1920, h: 1080 },
            { label: "QHD", w: 2560, h: 1440 },
            { label: "UW 34\"", w: 3440, h: 1440 },
            { label: "SUW 49\"", w: 5120, h: 1440 },
            { label: "4K UHD", w: 3840, h: 2160 }
        ];

        // --- NAVIGATION LOGIC ---
        
        window.addEventListener('scroll', () => {
            // Logic works for any view if page is scrollable
            const fab = document.getElementById('navFab');
            const fabText = document.getElementById('navFabText');
            const fabIcon = document.getElementById('navFabIcon');
            const fade = document.getElementById('bottomFade'); // Get the gradient
            
            const t = translations[currentLang];
            const scrollY = window.scrollY;
            const threshold = 100; // Trigger faster
            
            // --- GRADIENT FADE LOGIC (MORE AGGRESSIVE) ---
            const distToBottom = document.documentElement.scrollHeight - window.scrollY - window.innerHeight;
            
            if (distToBottom < 50) {
                fade.style.opacity = '0';
            } else if (distToBottom < 300) {
                const opacity = (distToBottom - 50) / 250;
                fade.style.opacity = opacity.toFixed(2);
            } else {
                fade.style.opacity = '1';
            }
            
            // Check if we need to switch to TOP (scrolled down)
            if (scrollY > threshold && !isFabAtTop && !isTransitioning) {
                isTransitioning = true;
                
                // 1. Fade Out
                fab.classList.add('opacity-0', 'scale-75');
                
                // 2. Wait for fade out, then swap properties
                setTimeout(() => {
                    isFabAtTop = true;
                    fab.classList.remove('bottom-8');
                    fab.classList.add('top-24'); // Position below navbar
                    
                    fabText.innerText = t.navBack;
                    fabIcon.className = "fa-solid fa-arrow-up text-lg";
                    
                    fab.onclick = () => {
                        fab.classList.add('opacity-0');
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        // Opacity restored by scroll logic when we pass threshold back up
                    };
                    
                    // 3. Fade In
                    fab.classList.remove('opacity-0', 'scale-75');
                    isTransitioning = false;
                }, 300); // Matches CSS duration
            } 
            // Check if we need to switch to BOTTOM (scrolled up)
            else if (scrollY <= threshold && isFabAtTop && !isTransitioning) {
                isTransitioning = true;
                
                // 1. Fade Out
                fab.classList.add('opacity-0', 'scale-75');
                
                // 2. Wait for fade out, then swap properties
                setTimeout(() => {
                    isFabAtTop = false;
                    fab.classList.remove('top-24');
                    fab.classList.add('bottom-8');
                    
                    fabText.innerText = t.navAsk;
                    fabIcon.className = "fa-solid fa-arrow-down text-lg";
                    
                    fab.onclick = () => {
                        fab.classList.add('opacity-0');
                        const aiSection = document.getElementById('aiSection');
                        aiSection.scrollIntoView({ behavior: 'smooth' });
                        // Opacity restored by scroll logic
                    };

                    // 3. Fade In
                    fab.classList.remove('opacity-0', 'scale-75');
                    isTransitioning = false;
                }, 300);
            }
        });

        // --- VIEW SWITCHING ---
        function switchView(view) {
            currentView = view;
            
            // Toggle Views
            const calcView = document.getElementById('view-calculator');
            const manView = document.getElementById('view-manifest');
            const fab = document.getElementById('navFab');
            
            if (view === 'calculator') {
                calcView.classList.remove('hidden');
                manView.classList.add('hidden');
                
                // Show FAB
                fab.style.display = 'flex'; 
                setTimeout(() => fab.classList.remove('opacity-0', 'translate-y-10'), 100);
                
                // Active Tabs
                document.getElementById('tab-calculator').classList.add('active');
                document.getElementById('tab-calculator').classList.remove('inactive');
                document.getElementById('tab-manifest').classList.add('inactive');
                document.getElementById('tab-manifest').classList.remove('active');
            } else {
                calcView.classList.add('hidden');
                manView.classList.remove('hidden');
                
                // Hide FAB
                fab.classList.add('opacity-0', 'translate-y-10');
                setTimeout(() => fab.style.display = 'none', 300); // Wait for transition
                
                // Active Tabs
                document.getElementById('tab-manifest').classList.add('active');
                document.getElementById('tab-manifest').classList.remove('inactive');
                document.getElementById('tab-calculator').classList.add('inactive');
                document.getElementById('tab-calculator').classList.remove('active');
            }
        }

        // --- INIT & LOGIC ---
        function init() {
            const userLang = navigator.language || navigator.userLanguage; 
            if (userLang.startsWith('pl')) currentLang = 'pl';
            
            if (localStorage.getItem('theme')) currentTheme = localStorage.getItem('theme');
            else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) currentTheme = 'light';
            
            applyTheme();
            updateLanguageUI();
            initPresetButtons();
            
            // Fix: Ensure FAB onclick is set initially
            const fab = document.getElementById('navFab');
            fab.onclick = () => {
                fab.classList.add('opacity-0');
                const aiSection = document.getElementById('aiSection');
                aiSection.scrollIntoView({ behavior: 'smooth' });
                // The scroll listener will handle showing it again as we cross the threshold
            };
            
            setTimeout(() => calculateMP(), 50);
            window.dispatchEvent(new Event('scroll'));
            window.addEventListener('resize', updatePresetUIState);
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
            localStorage.setItem('theme', currentTheme);
            applyTheme();
        }

        function applyTheme() {
            const html = document.documentElement;
            const icon = document.getElementById('themeIcon');
            if (currentTheme === 'dark') {
                html.classList.add('dark');
                icon.className = 'fa-solid fa-sun';
            } else {
                html.classList.remove('dark');
                icon.className = 'fa-solid fa-moon';
            }
        }

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'pl' : 'en';
            updateLanguageUI();
            if (!document.getElementById('resultPanel').classList.contains('hidden')) calculateMP();
            
            // Update FAB text immediately
            const t = translations[currentLang];
            const fabText = document.getElementById('navFabText');
            if (isFabAtTop) fabText.innerText = t.navBack;
            else fabText.innerText = t.navAsk;
        }

        function updateLanguageUI() {
            const t = translations[currentLang];
            const langBtn = document.getElementById('langToggle');
            const svg = currentLang === 'en' ? flags.en : flags.pl;
            const text = currentLang === 'en' ? 'EN' : 'PL';
            langBtn.innerHTML = `${svg} <span>${text}</span>`;
            
            // Translate Standard Strings
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) el.innerText = t[key];
            });

            // Translate Manifesto HTML Content
            const manifestContainer = document.querySelector('[data-i18n-html="manifestContent"]');
            if (manifestContainer) {
                manifestContainer.innerHTML = currentLang === 'pl' ? manifestPL : manifestEN;
            }
        }

        function initPresetButtons() {
            const container = document.getElementById('presetContainer');
            presets.forEach((p, index) => {
                const btn = document.createElement('button');
                btn.className = `preset-btn relative z-10 px-3 py-1.5 rounded text-sm transition-colors duration-200 font-medium bg-transparent text-slate-600 dark:text-slate-300 hover:bg-slate-200/50 dark:hover:bg-slate-800/50`;
                btn.innerText = p.label;
                btn.dataset.w = p.w; btn.dataset.h = p.h; btn.dataset.index = index;
                btn.onclick = () => setRes(p.w, p.h);
                container.appendChild(btn);
            });
        }

        function setRes(w, h) {
            document.getElementById('widthInput').value = w;
            document.getElementById('heightInput').value = h;
            calculateMP();
        }
        
        function updatePresetUIState() {
            const currentW = parseInt(document.getElementById('widthInput').value);
            const currentH = parseInt(document.getElementById('heightInput').value);
            const pill = document.getElementById('activePill');
            const buttons = document.querySelectorAll('.preset-btn');
            let foundMatch = false;

            buttons.forEach(btn => {
                const btnW = parseInt(btn.dataset.w);
                const btnH = parseInt(btn.dataset.h);
                if (btnW === currentW && btnH === currentH) {
                    foundMatch = true;
                    pill.style.opacity = '1';
                    pill.style.left = btn.offsetLeft + 'px';
                    pill.style.top = btn.offsetTop + 'px';
                    pill.style.width = btn.offsetWidth + 'px';
                    pill.style.height = btn.offsetHeight + 'px';
                    btn.classList.remove('text-slate-600', 'dark:text-slate-300', 'hover:bg-slate-200/50', 'dark:hover:bg-slate-800/50');
                    btn.classList.add('text-white');
                } else {
                    btn.classList.remove('text-white');
                    btn.classList.add('text-slate-600', 'dark:text-slate-300', 'hover:bg-slate-200/50', 'dark:hover:bg-slate-800/50');
                }
            });
            if (!foundMatch) pill.style.opacity = '0';
        }

        function calculateMP() {
            const width = parseInt(document.getElementById('widthInput').value);
            const height = parseInt(document.getElementById('heightInput').value);
            const t = translations[currentLang];
            
            if (!width || !height) return;

            updatePresetUIState();
            
            // Hide AI previous result if changed, but keep AI section visible
            document.getElementById('aiResult').classList.add('hidden');
            document.getElementById('aiContent').innerHTML = '';

            const pixels = width * height;
            const megapixels = (pixels / 1000000).toFixed(2);
            
            const fhdPixels = 1920 * 1080;
            const diff = ((pixels - fhdPixels) / fhdPixels) * 100;
            const diffStr = diff > 0 ? `+${diff.toFixed(0)}%` : `${diff.toFixed(0)}%`;
            
            // LOGIC FIX: Yellow for moderate increases (up to +80%, covers QHD), Red for high
            let colorClass = 'text-rose-500 dark:text-rose-400'; // Default high
            if (diff <= 0) {
                colorClass = 'text-emerald-500 dark:text-emerald-400';
            } else if (diff <= 80) {
                colorClass = 'text-amber-500 dark:text-amber-400';
            }

            const maxScale = 8300000; 
            const barWidth = Math.min((pixels / maxScale) * 100, 100);

            let className = "", verdict = "";
            if (megapixels < 1.5) { className = t.classes.legacy; verdict = t.verdicts.legacy; }
            else if (megapixels < 2.5) { className = t.classes.fhd; verdict = t.verdicts.fhd; }
            else if (megapixels < 4.5) { className = t.classes.qhd; verdict = t.verdicts.qhd; }
            else if (megapixels < 7.5) { className = t.classes.uw; verdict = t.verdicts.uw; }
            else if (megapixels < 30) { className = t.classes.uhd; verdict = t.verdicts.uhd; }
            else { className = t.classes.extreme; verdict = t.verdicts.extreme; }

            document.getElementById('mpValue').innerText = megapixels;
            document.getElementById('className').innerText = className;
            const diffEl = document.getElementById('percentageDiff');
            diffEl.innerText = `${diffStr} ${t.load}`;
            diffEl.className = `font-bold ${colorClass}`;
            document.getElementById('verdictText').innerText = verdict;
            
            document.getElementById('placeholderState').classList.add('hidden');
            const resultPanel = document.getElementById('resultPanel');
            resultPanel.classList.remove('hidden');
            void resultPanel.offsetWidth;
            resultPanel.classList.remove('opacity-0');
            setTimeout(() => document.getElementById('progressBar').style.width = `${barWidth}%`, 100);
        }

        async function askGemini() {
            const width = document.getElementById('widthInput').value;
            const height = document.getElementById('heightInput').value;
            const mp = document.getElementById('mpValue').innerText;
            
            const resultDiv = document.getElementById('aiResult');
            const loadingDiv = document.getElementById('aiLoading');
            const contentDiv = document.getElementById('aiContent');
            const btn = document.getElementById('aiButton');
            
            if (!apiKey) {
                contentDiv.innerHTML = `<p class="text-amber-500 dark:text-amber-400"><b>Brak klucza API!</b><br>Aby AI działało lokalnie lub na Twojej stronie, musisz wygenerować darmowy klucz Google Gemini API.<br><a href="https://aistudio.google.com/app/apikey" target="_blank" class="underline hover:text-amber-600 dark:hover:text-amber-300">Pobierz klucz tutaj</a> i wklej go w kodzie (linia ~700) w miejscu: <code>const apiKey = "TWOJ_KLUCZ";</code></p>`;
                resultDiv.classList.remove('hidden');
                loadingDiv.classList.add('hidden');
                return;
            }

            resultDiv.classList.remove('hidden');
            loadingDiv.classList.remove('hidden');
            contentDiv.innerHTML = '';
            btn.disabled = true;
            btn.classList.add('opacity-50', 'cursor-not-allowed');

            const systemPrompt = "You are a hardcore PC hardware expert. Be concise, technical, witty. Recommend GPUs for this resolution.";
            const userPrompt = `Width: ${width}, Height: ${height}, ${mp} Megapixels. Lang: ${currentLang}. 
            Task: 1. Demand vs 1080p. 2. Recommended GPU tiers for 60FPS AAA. 3. Specific models (NVIDIA/AMD). Short, bullet points.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: userPrompt }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });
                const data = await response.json();
                if (data.error) throw new Error(data.error.message);
                contentDiv.innerHTML = marked.parse(data.candidates[0].content.parts[0].text);
            } catch (error) {
                contentDiv.innerHTML = `<p class="text-rose-500">Error: ${error.message}</p>`;
            } finally {
                loadingDiv.classList.add('hidden');
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', () => updatePresetUIState());
            input.addEventListener('keypress', (e) => { if (e.key === 'Enter') calculateMP(); });
        });
        
        init();
    </script>
</body>
</html>